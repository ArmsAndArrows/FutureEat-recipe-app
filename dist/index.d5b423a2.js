const e=async function(e,t){try{const a=t?fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}):fetch(e),i=await Promise.race([a,(n=10,new Promise((function(e,t){setTimeout((function(){t(new Error("Request took too long!"))}),1e3*n)})))]),r=await i.json();if(!i.ok)throw new Error(`${r.message} ${i.status}`);return r}catch(e){throw e}var n},t={recipe:{},search:{query:"",page:1,results:[],resultsPerPage:10},bookmarks:[]},n=function(e){const{recipe:t}=e.data;return{id:t.id,title:t.title,publisher:t.publisher,sourceUrl:t.source_url,image:t.image_url,servings:t.servings,cookingTime:t.cooking_time,ingredients:t.ingredients,...t.key&&{key:t.key}}},a=function(e=t.search.page){t.search.page=e;const n=(e-1)*t.search.resultsPerPage,a=10*e;return t.search.results.slice(n,a)},i=function(){localStorage.setItem("bookmarks",JSON.stringify(t.bookmarks))},r=function(e){t.bookmarks.push(e),e.id===t.recipe.id&&(t.recipe.bookmarked=!0),i()};!function(){const e=localStorage.getItem("bookmarks");e&&(t.bookmarks=JSON.parse(e))}();class s{_data;render(e){if(!e||Array.isArray(e)&&0===e.length)return this.renderError();this._data=e;const t=this._generateMarkup();this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}update(e){this._data=e;const t=this._generateMarkup(),n=document.createRange().createContextualFragment(t),a=Array.from(n.querySelectorAll("*")),i=Array.from(this._parentElement.querySelectorAll("*"));a.forEach(((e,t)=>{const n=i[t];e.isEqualNode(n)||""===e.firstChild?.nodeValue.trim()||(n.textContent=e.textContent),e.isEqualNode(n)||Array.from(e.attributes).forEach((e=>n.setAttribute(e.name,e.value)))}))}_clear(){this._parentElement.innerHTML=""}waiting(){this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",'<img class="loading-img" src="assets/recipe-cook.gif" alt="wait for a while">')}renderError(e=this._errorMessage){const t=`\n      <div>\n         <div class="error">\n            <i class="fa-solid fa-bomb"></i>\n            <p class="error__msg">${e}</p>\n         </div>\n      </div>\n      `;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}renderMessage(e=this._message){const t=`\n      <div>\n         <div class="error">\n         <i class="fa-regular fa-face-smile-beam welcome__smile"></i>\n         <p class="welcome__message">\n           ${e}\n         </p>\n         </div>\n      </div>\n      `;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}}var o=new class extends s{_parentElement=document.querySelector(".recipe-container");_errorMessage="We couldn't find that recipe. Please, try another one";addHandlerRender(e){["hashchange","load"].forEach((t=>window.addEventListener(t,e)))}addHandlerUpdateServings(e){this._parentElement.addEventListener("click",(function(t){const n=t.target.closest(".detail__button");if(!n)return;const a=+n.dataset.updateTo;+a>0&&e(+a)}))}addHandlerAddBookmark(e){this._parentElement.addEventListener("click",(function(t){t.target.closest(".btn--bookmark")&&e()}))}_generateMarkup(){return`<div class="recipe">\n    \x3c!--LOGO recipe--\x3e\n    <header class="recipe__logo">\n      <img\n        class="recipe__img"\n        src="${this._data.image}"\n        alt="${this._data.title}"\n      />\n      <h1 class="recipe__title">${this._data.title}</h1>\n    </header>\n     \x3c!--DETAILS--\x3e\n    <div class="details">\n      <div class="details__block">\n        <div class="detail">\n          <i class="fa-regular fa-clock"></i\n          ><span class="detail__number">${this._data.cookingTime}</span\n          ><span class="detail__text">minutes</span>\n        </div>\n        <div class="detail">\n          <i class="fa-solid fa-people-group"></i>\n          <span class="detail__number">${this._data.servings}</span>\n          <span class="detail__text">servings</span>\n          <div class="detail__servings">\n            <button data-update-to="${this._data.servings-1}" class="detail__button detail__button--decrease">-</button>\n            <button data-update-to="${this._data.servings+1}" class="detail__button detail__button--increase">+</button>\n          </div>\n        </div>\n      </div>\n      <div class="preview__user-generated ${this._data.key?"":"hidden"}">\n            <i class="fa-solid fa-cookie"></i>\n      </div>\n      <button class="details__bookmark ${this._data.bookmarked?"details__bookmark--active":""} btn--bookmark ">\n        <i class="fa-regular fa-bookmark"></i>\n      </button>\n    </div>\n     \x3c!--INGREDIENTS--\x3e\n     <div class="ingredients">\n      <h2 class="ingredients__title">Recipe ingredients</h2>\n      <ul class="ingredients__table">\n        ${this._data.ingredients.map((e=>`<li class="ingredient"><i class="fa-solid fa-check ingredient__icon"></i><span class="ingredient__number">${e.quantity?e.quantity:" "} ${e.unit} ${e.description}</span>\n              \n              </li>`)).join("")}\n        \n        \n        \n\n\n      </ul>\n\n     </div>\n     \x3c!--HOW TO COOK IT--\x3e\n     <div class="cooking">\n      <h2 class="cooking__title">How to cook it</h2>\n      <p class="cooking__paragraph">This recipe was carefully designed and tested by <b>${this._data.publisher}</b>. Please check out directions at their website. </p>\n      <a href="${this._data.sourceUrl}" class="cooking__btn">Directions <i class="fa-solid fa-arrow-right"></i></a>\n\n     </div>\n  </div>`}};var c=new class{_parentElement=document.querySelector(".navigation__form");getQuery(){const e=this._parentElement.querySelector(".navigation__input").value;return this._clearInput(),e}_clearInput(){this._parentElement.querySelector(".navigation__input").value=""}addHandlerSearch(e){this._parentElement.addEventListener("submit",(function(t){t.preventDefault(),e()}))}};var l=new class extends s{_parentElement=document.querySelector(".results");_errorMessage="No recipes found for your query! Please, try again ;)";_generateMarkup(){return this._data.map(this._generateMarkupPreview).join("")}_generateMarkupPreview(e){const t=window.location.hash.slice(1);return` <li class="preview">\n        <a href="#${e.id}" class="preview__link ${e.id===t?"preview__link--active":""}">\n          <figure class="preview__fig">\n            <img class="preview__img" src="${e.image}" alt="${e.title}">\n            <div class="preview__data">\n              <h4 class="preview__title">${e.title}</h4>\n              <p class="preview__publisher">${e.publisher}</p>\n              \n            </div>\n            <div class="preview__user-generated">\n              <i class="fa-solid fa-cookie"></i>\n            </div>\n\n          </figure>\n        </a>\n      </li>\n        `}};var d=new class extends s{_parentElement=document.querySelector(".pages");addHandlerClick(e){this._parentElement.addEventListener("click",(function(t){const n=t.target.closest(".inline-btn");if(!n)return;const a=+n.dataset.goto;e(a)}))}_generateMarkup(){const e=this._data.page,t=Math.ceil(this._data.results.length/this._data.resultsPerPage);return 1===e&&t>1?`<div></div> <button data-goto="${e+1}" class="inline-btn inline-btn--next"><span>Page ${e+1} </span><i class="fa-solid fa-arrow-right"></i></button>`:e===t&&t>1?`<button data-goto="${e-1}" class="inline-btn inline-btn--prev"><i class="fa-solid fa-arrow-left"></i><span> Page ${e-1}</span></button>`:e<t?`<button data-goto="${e-1}" class="inline-btn inline-btn--prev"><i class="fa-solid fa-arrow-left"></i><span> Page ${e-1}</span></button><button data-goto="${e+1}" class="inline-btn inline-btn--next"><span>Page ${e+1} </span><i class="fa-solid fa-arrow-right"></i></button>`:""}};var u=new class extends s{_parentElement=document.querySelector(".bookmarks__list");_errorMessage="No bookmarks yet. Find a nice recipe and bookmark it :)";_generateMarkup(){return this._data.map(this._generateMarkupPreview).join("")}addHandlerRender(e){window.addEventListener("load",e)}_generateMarkupPreview(e){window.location.hash.slice(1);return` <li class="preview">\n      <a href="#${e.id}" class="preview__link">\n        <figure class="preview__fig">\n          <img class="preview__img" src="${e.image}" alt="test">\n          <div class="preview__data">\n            <h4 class="preview__title">${e.title}</h4>\n            <p class="preview__publisher">${e.publisher}</p>\n            \n          </div>\n          <div class="preview__user-generated">\n          <i class="fa-solid fa-cookie"></i>\n          </div>\n\n        </figure>\n      </a>\n    </li>\n      `}};var p=new class extends s{_parentElement=document.querySelector(".upload");_message="Recipe was successfully uploaded :)";_window=document.querySelector(".add-recipe-window");_overlay=document.querySelector(".overlay");_btnOpen=document.querySelector(".navigation__link--add-recipe");_btnClose=document.querySelector(".btn--close-modal");constructor(){super(),this._addHandlerShowWindow(),this._addHandlerHideWindow()}toggleWindow(){this._overlay.classList.toggle("hidden"),this._window.classList.toggle("hidden")}_addHandlerShowWindow(){this._btnOpen.addEventListener("click",this.toggleWindow.bind(this))}_addHandlerHideWindow(){this._btnClose.addEventListener("click",this.toggleWindow.bind(this)),this._overlay.addEventListener("click",this.toggleWindow.bind(this))}addHandlerUpload(e){this._parentElement.addEventListener("submit",(function(t){t.preventDefault();const n=[...new FormData(this)],a=Object.fromEntries(n);e(a)}))}};const _=async function(){try{const i=window.location.hash.slice(1);if(!i)return;o.waiting(),l.update(a()),await async function(a){try{const i=await e(`https://forkify-api.herokuapp.com/api/v2/recipes/${a}?key=ca13faa3-9450-415c-9bb6-f24e0a7f9cbe`);t.recipe=n(i),t.bookmarks.some((e=>e.id===a))?t.recipe.bookmarked=!0:t.recipe.bookmarked=!1}catch(e){throw console.error(`${e}`),e}}(i),o.render(t.recipe),u.update(t.bookmarks),document.querySelector(".search-results").classList.remove("search-results--mobile")}catch(e){console.log(e),o.renderError("We could not find that recipe. Please Try another one!")}},h=async function(){try{const n=c.getQuery();if(!n)return;l.waiting(),document.querySelector(".search-results").classList.add("search-results--mobile"),await async function(n){try{t.search.query=n;const a=await e(`https://forkify-api.herokuapp.com/api/v2/recipes?search=${n}&key=ca13faa3-9450-415c-9bb6-f24e0a7f9cbe`);t.search.results=a.data.recipes.map((e=>({id:e.id,title:e.title,publisher:e.publisher,image:e.image_url,...e.key&&{key:e.key}}))),t.search.page=1}catch(e){throw console.log(e),e}}(n),l.render(a(1)),u.update(t.bookmarks),d.render(t.search)}catch(e){console.log(e),o.renderError(`${e}`)}},g=function(e){l.render(a(e)),d.render(t.search)},m=function(e){!function(e){t.recipe.ingredients.forEach((n=>{n.quantity&&(n.quantity=(n.quantity*e/t.recipe.servings).toFixed(2))})),t.recipe.servings=e}(e),o.render(t.recipe)},f=function(){t.recipe.bookmarked?function(e){const n=t.bookmarks.findIndex((t=>t.id===e));t.bookmarks.splice(n,1),e===t.recipe.id&&(t.recipe.bookmarked=!1),i()}(t.recipe.id):r(t.recipe),o.update(t.recipe),u.render(t.bookmarks)},k=function(){u.render(t.bookmarks)},b=async function(a){try{p.waiting(),await async function(a){try{const i=Object.entries(a).filter((e=>e[0].startsWith("ingredient")&&""!==e[1])).map((e=>{const t=e[1].split(",").map((e=>e.trim()));if(3!==t.length)throw new Error("Wrong ingredient format, please use correct format");const[n,a,i]=t;return{quantity:n?+n:null,unit:a,description:i}})),s={title:a.title,source_url:a.sourceUrl,image_url:a.image,publisher:a.publisher,cooking_time:+a.cookingTime,servings:+a.servings,ingredients:i},o=await e("https://forkify-api.herokuapp.com/api/v2/recipes/?key=ca13faa3-9450-415c-9bb6-f24e0a7f9cbe",s);t.recipe=n(o),r(t.recipe)}catch(e){throw e}}(a),o.render(t.recipe),p.renderMessage(),u.render(t.bookmarks),window.history.pushState(null,"",`#${t.recipe.id}`),setTimeout((function(){p.toggleWindow()}),2500)}catch(e){console.log(e),p.renderError(e.message),setTimeout((function(){location.reload()}),5e3)}};u.addHandlerRender(k),o.addHandlerRender(_),o.addHandlerUpdateServings(m),o.addHandlerAddBookmark(f),c.addHandlerSearch(h),d.addHandlerClick(g),p.addHandlerUpload(b);
//# sourceMappingURL=index.d5b423a2.js.map
